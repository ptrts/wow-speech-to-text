import pytest

import app.tokens_to_text_builder as tokens_to_text_builder


@pytest.mark.parametrize("name, calls, result", [
    # ("Простая отправка одного слова", [(False, "зима")], "Зима"),
    # ("Простая отправка двух слов", [(False, "зима осень")], "Зима осень"),
    # ("Простая отправка трех слов", [(False, "зима осень лето")], "Зима осень лето"),
    # ("Слово без финала, повтор слова. Слово не двоится", [(False, "зима"), (False, "зима")], "Зима"),
    # ("Слово без финала, другое слово. Слово заменяется на другое", [(False, "зима"), (False, "другое")], "Другое"),
    # ("Три слова без финала, они же. Слова не двоятся", [(False, "зима осень лето"), (False, "зима осень лето")], "Зима осень лето"),
    # ("Три слова без финала, они же без последнего слова. Остается укороченное сочетание", [(False, "зима осень лето"), (False, "зима осень")], "Зима осень"),
    # ("Три слова без финала, совсем другое. Остается только последнее сочетание слов", [(False, "зима осень лето"), (False, "совсем другое")], "Совсем другое"),
    # ("Три слова без финала, то же сочетание с заменой последнего слова. Остается только сочетание с заменой", [(False, "зима осень лето"), (False, "зима частично другое")], "Зима частично другое"),
    # ("Удаление", [(False, "зима осень лето"), (False, "зима осень лето удалить")], "Зима осень"),
    # ("Два удаления", [(False, "зима осень лето"), (False, "зима осень лето удалить удалить")], "Зима"),
    # ("Три удаления до пустой строки", [(False, "зима осень лето"), (False, "зима осень лето удалить удалить удалить")], ""),
    # ("Три удаления до пустой строки и еще одно", [(False, "зима осень лето"), (False, "зима осень лето удалить удалить удалить удалить")], ""),
    # ("Две серии удалений. Вторая удалят оставшееся слово идущее до первого удаления", [(False, "зима осень лето"), (False, "зима осень лето удалить море песок удалить удалить удалить")], "Зима"),
    # ("Серии удалений. Каждая удаляет не все слова идущие перед собой", [(False, "зима осень лето"), (False, "зима осень лето удалить море песок удалить волна поет удалить а мы такие загораем удалить")], "Зима осень море волна а мы такие"),
    # ("Удаление после финала", [(True , "зима осень лето"), (False, "удалить")], "Зима осень"),
    # ("Удаление после финала с добавкой", [(True , "зима осень лето"), (False, "удалить весна")], "Зима осень весна"),
    # ("Два удаления после финала и после одного слова", [(True , "зима осень лето"), (False, "весна удалить удалить")], "Зима осень"),
    # ("Очистка и добавление", [(False, "зима осень лето"), (False, "зима осень лето очистить море поет")], "Море поет"),
    # ("Очистка, добавление, еще очистка", [(False, "зима осень лето"), (False, "зима осень лето очистить море поет очистить")], ""),
    # ("Очистка, добавление, еще очистка, добавление", [(False, "зима осень лето"), (False, "зима осень лето очистить море поет очистить раз пошли на дело")], "Раз пошли на дело"),
    # ("Очистка после финала", [(True , "зима осень лето"), (False, "очистить")], ""),
    # ("Очистка после финала с добавлением", [(True , "зима осень лето"), (False, "очистить весна")], "Весна"),
    # ("Очистка после финала и после одного слова с добавлением", [(True , "зима осень лето"), (False, "весна очистить море")], "Море"),
    # ("Завершение команды после финала", [(True , "зима открывающая"), (False, "скобка")], "Зима ("),
    # ("Завершение команды после финала с добавлением", [(True , "зима открывающая"), (False, "скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит после удаления", [(False, "зима открывающая сопка удалить скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит после двух удалений", [(False, "зима открывающая сопка сопка удалить удалить скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит после одного удаления до финала", [(True , "зима открывающая сопка удалить"), (False, "скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит после одного удаления после финала", [(True , "зима открывающая сопка"), (False, "удалить скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит после одного удаления до финала и одного - после финала", [(True , "зима открывающая сопка сопка удалить"), (False, "удалить скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит после серии удалений до финала", [(True , "зима открывающая сопка сопка удалить удалить"), (False, "скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит после двух отдельных удалений до финала", [(True , "зима открывающая сопка удалить сопка удалить"), (False, "скобка осень")], "Зима (осень"),
    # ("Завершение команды приходит нескольких отдельных удалений до и после финала", [(True , "зима открывающая сопка удалить сопка"), (False, "удалить сопка сопка удалить удалить скобка осень")], "Зима (осень"),
    ("Завершение команды из трех слов после нескольких серий удалений до и после финала", [(True , "зима точка с за тобой удалить"), (False, "удалить удалить с за тобой удалить удалить запятой осень")], "Зима (осень"),
    # ("Удаление завершения команды", [(True , "зима точка с запятой лето удалить удалить")], "Зима. С"),
    # ("Удаление и восстановление завершения команды", [(True , "зима точка с запятой лето удалить удалить запятой весна")], "Зима; весна"),
    # ("Удаление завершения команды после финала", [(True , "зима точка с запятой лето"), (False, "удалить удалить")], "Зима. С"),
    # ("Завершение команды не приходит во второй раз", [(False, "зима открывающая скобка лето"), (False, "зима открывающая лето")], "Зима открывающая лето"),
    # ("Удаление завершения команды не приходит во второй раз", [(False, "зима открывающая скобка удалить лето"), (False, "зима открывающая скобка утолить лето")], "Зима (утолить лето"),
    # ("Очистка текста с командой не приходит во второй раз", [(False, "зима открывающая скобка очистить лето"), (False, "зима открывающая скобка обчистить лето")], "Зима (обчистить лето"),
    # ("Большие буквы в начале предложения", [(False, "зима лето точка весна осень восклицательный знак море зовет вопросительный знак волна поет точка")], "Зима лето. Весна осень! Море зовет? Волна поет."),
    # ("Слово в скобках в начале текста", [(False, "открывающая скобка зима закрывающая скобка лето")], "(Зима) лето"),
    # ("Слово в двойных скобках в начале текста", [(False, "открывающая скобка открывающая скобка зима закрывающая скобка закрывающая скобка лето")], "((Зима)) лето"),
    # ("Слово в кавычках и в скобках в начале текста", [(False, "открывающая скобка кавычки зима кавычки закрывающая скобка лето")], '("Зима") лето'),
    # ("Слово в скобках и в кавычках в начале текста", [(False, "кавычки открывающая скобка зима закрывающая скобка кавычки лето")], '"(Зима)" лето'),
    # ("Слово в двойных скобках и в кавычках в начале текста", [(False, "кавычки открывающая скобка открывающая скобка зима закрывающая скобка закрывающая скобка кавычки лето")], '"((Зима))" лето'),
    # ("Слово в кавычках и в двойных скобках в начале текста", [(False, "открывающая скобка открывающая скобка кавычки зима кавычки закрывающая скобка закрывающая скобка лето")], '(("Зима")) лето'),
    # ("Слово в скобках в начале предложения", [(False, "зима лето точка открывающая скобка зима закрывающая скобка лето")], "Зима лето. (Зима) лето"),
    # ("Слово в двойных скобках в начале предложения", [(False, "зима лето точка открывающая скобка открывающая скобка зима закрывающая скобка закрывающая скобка лето")], "Зима лето. ((Зима)) лето"),
    # ("Слово в кавычках и в скобках в начале предложения", [(False, "зима лето точка открывающая скобка кавычки зима кавычки закрывающая скобка лето")], 'Зима лето. ("Зима") лето'),
    # ("Слово в скобках и в кавычках в начале предложения", [(False, "зима лето точка кавычки открывающая скобка зима закрывающая скобка кавычки лето")], 'Зима лето. "(Зима)" лето'),
    # ("Слово в двойных скобках и в кавычках в начале предложения", [(False, "зима лето точка кавычки открывающая скобка открывающая скобка зима закрывающая скобка закрывающая скобка кавычки лето")], 'Зима лето. "((Зима))" лето'),
    # ("Слово в кавычках и в двойных скобках в начале предложения", [(False, "зима лето точка открывающая скобка открывающая скобка кавычки зима кавычки закрывающая скобка закрывающая скобка лето")], 'Зима лето. (("Зима")) лето'),
    # ("Слово в скобках в середине предложения", [(False, "лето открывающая скобка зима закрывающая скобка")], "Лето (зима)"),
    # ("Слово в двойных скобках в середине предложения", [(False, "лето открывающая скобка открывающая скобка зима закрывающая скобка закрывающая скобка")], "Лето ((зима))"),
    # ("Слово в кавычках и в скобках в середине предложения", [(False, "лето открывающая скобка кавычки зима кавычки закрывающая скобка")], 'Лето ("зима")'),
    # ("Слово в скобках и в кавычках в середине предложения", [(False, "лето кавычки открывающая скобка зима закрывающая скобка кавычки")], 'Лето "(зима)"'),
    # ("Слово в двойных скобках и в кавычках в середине предложения", [(False, "лето кавычки открывающая скобка открывающая скобка зима закрывающая скобка закрывающая скобка кавычки")], 'Лето "((зима))"'),
    # ("Слово в кавычках и в двойных скобках в середине предложения", [(False, "лето открывающая скобка открывающая скобка кавычки зима кавычки закрывающая скобка закрывающая скобка")], 'Лето (("зима"))'),
    # ("Запятая", [(False, "зима запятая лето")], 'Зима, лето'),
    # ("Точка с запятой", [(False, "зима точка с запятой лето")], 'Зима; лето'),
    # ("Двоеточие", [(False, "зима двоеточие лето")], 'Зима: лето'),
    # ("Многоточие", [(False, "зима многоточие лето")], 'Зима... лето'),
    # ("Скобки", [(False, "зима открывающая скобка лето закрывающая скобка")], 'Зима (лето)'),
    # ("Кавычки", [(False, "зима кавычки лето кавычки весна кавычки лето кавычки точка")], 'Зима "лето" весна "лето".'),
    # ("Дефис", [(False, "зима дефис лето")], 'Зима-лето'),
    # ("Тире", [(False, "зима тире лето")], 'Зима - лето'),
    # ("Слэш", [(False, "зима слэш лето")], 'Зима/лето'),
    # ("Обратный слэш", [(False, "зима обратный слэш лето")], 'Зима\\лето'),
])
def test(name: str, calls: list[tuple[bool, str]], result: str):
    tokens_to_text_builder.reset()
    for call in calls:
        is_final = call[0]
        tokens = call[1].split()
        tokens_to_text_builder.build_text(tokens, is_final)

    assert tokens_to_text_builder.text == result
